---
import { getCollection } from "astro:content";
import BaseLayout from "../layouts/BaseLayout.astro";
import Hero from "../components/Hero.astro";
import Sidebar from "../components/Sidebar.astro";
import Footer from "../components/Footer.astro";
import Pagination from "../components/Pagination.astro";
import ArticleList from "../components/ArticleList.astro";
import { POSTS_PER_PAGE } from "../config/config.mts";

const currentPage = 1;
const allPosts = await getCollection("blog");
const sortedPosts = allPosts.sort((a, b) => new Date(b.data.date as any).getTime() - new Date(a.data.date as any).getTime());
const posts = sortedPosts.slice(0, POSTS_PER_PAGE);
const totalPages = Math.ceil(allPosts.length / POSTS_PER_PAGE);
const baseLink = "/";

---

<BaseLayout title="‰∏™‰∫∫ÂçöÂÆ¢ | My Blog">
	<Hero title="‚òò‰Ω†Â•ΩÂëÄ~‚òò" subtitle="üçÄÊ¨¢ËøéÊù•Âà∞ LYGreen ÁöÑÂçöÂÆ¢ÔºÅüçÄ" />
	
	<div class="container">
		<main>
			<ArticleList posts={posts} />
            <Pagination currentPage={currentPage} totalPages={totalPages} baseLink={baseLink} />
		</main>

		<Sidebar />
	</div>

	<Footer />
</BaseLayout>

<style>

	/* ===== ‰∏ªÂÆπÂô®Â∏ÉÂ±Ä (Grid) ===== */
	.container {
		max-width: 1100px;
		margin: 0 auto;
		padding: 20px;
		display: grid;
		grid-template-columns: 3fr 1fr;
		gap: 30px;
	}

	aside {
		align-self: self-start;
		top: 80px;
	}

	/* ===== ÂìçÂ∫îÂºè ===== */
	@media (max-width: 768px) {
		.container {
			grid-template-columns: 1fr;
		}
		:global(aside) {
			display: none;
		}
	}
</style>
